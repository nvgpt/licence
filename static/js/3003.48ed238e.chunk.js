"use strict";(self.webpackChunklicencenow=self.webpackChunklicencenow||[]).push([[3003],{93003:(e,s,r)=>{r.r(s),r.d(s,{default:()=>v});var a=r(65043),l=r(53519),i=r(61072),t=r(78602),n=r(13892),o=r(81140),d=r(73216),c=r(35475),m=r(80899),u=r(30064),h=r.n(u),p=r(26917),f=r(8729),_=r(94745),x=r(86213),g=r(63401),j=(r(92342),r(71505)),b=r(70579);function v(){const{userData:e,token:s,setNewProfileImg:r}=(0,f.A)(),[u,v]=(0,a.useState)(!1),[N,F]=(0,a.useState)([]),[k,y]=(0,a.useState)(""),[S,A]=(0,a.useState)(o),[P,E]=(0,a.useState)(null),[C,D]=(0,a.useState)({}),[w,I]=(0,a.useState)(""),[$,R]=(0,a.useState)(),[V,M]=(0,a.useState)(),[T,B]=(0,a.useState)(),[H,L]=(0,a.useState)({suburbID:"",suburbName:""}),[O,W]=(0,a.useState)({stateID:"",stateName:""}),[q,z]=(0,a.useState)(),U=(0,d.Zp)();(0,a.useEffect)((()=>{(async()=>{v(!0);try{const e=await x.A.get(`https://ready-set-driving-school.pwd.net.au${p.A.LEARBER_PREFERENCES}`,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(e.data.success){const s=e.data.data;F(s.language_spoken||[]),y(s.preferred_transmission||""),A(s.profile_picture||o),B(s.preferred_pickup_address||""),I(s.optional_note_instructor||""),R(s.sms_comm_offer),M(s.email_comm_offer),L({suburbID:s.suburb_id,suburbName:s.suburb}),W({stateID:s.state,stateName:s.state_name,stateSlug:s.state_slug}),z(s.postcode)}}catch(e){console.error("Error fetching instructor details:",e)}finally{v(!1)}})()}),[e.id,s]);const Y=m.Ik().shape({preferred_transmission:m.Yj().required("Transmission type is required")}),G=e=>{const s=e.target.files[0];if(s){E(s);const e=new FileReader;e.onload=()=>{A(e.result)},e.readAsDataURL(s)}},Z=e=>{let{addressSuburb:s}=e;const{setFieldValue:r}=(0,n.j7)();return(0,a.useEffect)((()=>{s&&r("billing_address",s)}),[s,r]),null};return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{className:"mainContent",children:[(0,b.jsx)(_.A,{}),(0,b.jsxs)("div",{className:"mainContent__assets",children:[(0,b.jsx)(l.A,{children:(0,b.jsx)(i.A,{children:(0,b.jsx)(t.A,{lg:12,children:(0,b.jsxs)("div",{className:"personalDetailsForm",children:[(0,b.jsx)(c.N_,{onClick:()=>U(-1),children:"< Go back "}),(0,b.jsx)("h2",{children:"My Preferences"}),(0,b.jsxs)("div",{className:"personalDetailsForm__wrp",children:[(0,b.jsxs)("div",{className:"personalDetailsForm__top",children:[" ",(0,b.jsx)("h4",{children:"My Profile"})," "]}),(0,b.jsx)(n.l1,{enableReinitialize:!0,initialValues:{languages_spoken:N.join(", ")||"",preferred_transmission:k||"",email_comm_offer:V||"0",sms_comm_offer:$||"0",profile_picture:P,optional_note_instructor:w},validationSchema:Y,onSubmit:async(e,a)=>{let{setSubmitting:l}=a;v(!0);const i=new FormData;Object.entries(e).forEach((e=>{let[s,r]=e;if("languages_spoken"===s){r.split(",").map((e=>e.trim())).forEach(((e,s)=>{i.append(`languages_spoken[${s}]`,e)}))}else{var a,l,t,n,o,d,c,m,u,h,p;i.append(s,r),i.append("preferred_pickup_address",C.length>0?`${null===(a=C[0])||void 0===a?void 0:a.long_name} ${null===(l=C[1])||void 0===l?void 0:l.long_name} ${null===(t=C[2])||void 0===t?void 0:t.short_name} ${null===(n=C[C.length-3])||void 0===n?void 0:n.long_name} ${null===(o=C[C.length-2])||void 0===o?void 0:o.long_name} ${null===(d=C[C.length-1])||void 0===d?void 0:d.long_name}`:T||""),i.append("suburb",(null===(c=C[C.length-5])||void 0===c?void 0:c.long_name)||H.suburbName),i.append("state",(null===(m=C[C.length-3])||void 0===m?void 0:m.long_name)||O.stateName),i.append("state_name",(null===(u=C[C.length-3])||void 0===u?void 0:u.long_name)||O.stateName),i.append("state_slug",(null===(h=C[C.length-3])||void 0===h?void 0:h.short_name)||O.stateSlug),i.append("postcode",(null===(p=C[C.length-1])||void 0===p?void 0:p.long_name)||q),i.append("suburbId",H.suburbID||""),i.append("stateId",O.stateID||"")}}));try{v(!0);let e={method:"post",maxBodyLength:1/0,url:`https://ready-set-driving-school.pwd.net.au${p.A.UPDATE_LEARNER_PREFERENCES}`,headers:{Authorization:`Bearer ${s}`,"Content-Type":"multipart/form-data"},data:i};x.A.request(e).then((e=>{e.data.success?(h().fire("Success!","Your profile has been updated.","success"),r(e.data.data.profile_picture),sessionStorage.setItem("profileImg",e.data.data.profile_picture)):h().fire("Error!",`${e.data.message}`,"error")})).catch((e=>{h().fire("Error!",`${e.response.data.message}`,"error"),v(!1)}))}catch(t){console.error("Error updating details:",t),h().fire("Error!","An error occurred while updating details. Please try again.","error")}finally{v(!1),l(!1)}},children:e=>{var s,r;let{errors:a,touched:l}=e;return(0,b.jsxs)(n.lV,{className:"ProfileForm RegistrationForm",children:[(0,b.jsx)(Z,{addressSuburb:C}),(0,b.jsxs)("fieldset",{children:[(0,b.jsxs)("div",{className:"ProfileForm__infoWrp",children:[(0,b.jsxs)("div",{className:"ProfileForm__photo",children:[(0,b.jsx)("img",{src:S,alt:"Profile",className:"ProfileForm__photo--image"}),(0,b.jsxs)("label",{children:[(0,b.jsx)("p",{children:"Edit Photo"}),(0,b.jsx)("input",{type:"file",placeholder:"Edit Photo",accept:"image/*",onChange:G})]})]}),(0,b.jsxs)("div",{className:"ProfileForm__group",style:{width:"100%"},children:[(0,b.jsx)("label",{htmlFor:"about_your_self",children:"* Preferred Transmission"}),(0,b.jsxs)("div",{className:"ProfileForm__group d-flex gap-3 m-1",children:[(0,b.jsxs)("div",{className:"ProfileForm__checkboxWrp",children:[(0,b.jsx)(n.D0,{name:"preferred_transmission",children:e=>{let{field:s,form:r}=e;return(0,b.jsx)("input",{type:"radio",id:"preferred_transmission_auto",checked:2===s.value,onChange:()=>r.setFieldValue("preferred_transmission",2)})}}),(0,b.jsx)("span",{}),(0,b.jsx)("div",{className:"CheckboxHighlight"}),(0,b.jsx)("label",{htmlFor:"preferred_transmission_auto",children:" Auto "})]}),(0,b.jsxs)("div",{className:"ProfileForm__checkboxWrp",children:[(0,b.jsx)(n.D0,{name:"preferred_transmission",children:e=>{let{field:s,form:r}=e;return(0,b.jsx)("input",{type:"radio",id:"preferred_transmission_manual",checked:3===s.value,onChange:()=>r.setFieldValue("preferred_transmission",3)})}}),(0,b.jsx)("span",{}),(0,b.jsx)("div",{className:"CheckboxHighlight"}),(0,b.jsx)("label",{htmlFor:"preferred_transmission_manual",children:" Manual "})]}),(0,b.jsxs)("div",{className:"ProfileForm__checkboxWrp",children:[(0,b.jsx)(n.D0,{name:"preferred_transmission",children:e=>{let{field:s,form:r}=e;return(0,b.jsx)("input",{type:"radio",id:"preferred_transmission_both",checked:1===s.value,onChange:()=>r.setFieldValue("preferred_transmission",1)})}}),(0,b.jsx)("span",{}),(0,b.jsx)("div",{className:"CheckboxHighlight"}),(0,b.jsx)("label",{htmlFor:"preferred_transmission_both",children:" Both "})]}),a.preferred_transmission&&l.preferred_transmission&&(0,b.jsx)("div",{className:"error",children:a.preferred_transmission})]}),(0,b.jsx)("label",{htmlFor:"languages_spoken",children:" * Language Spoken  "}),(0,b.jsx)(n.D0,{type:"text",name:"languages_spoken",id:"languages_spoken",className:"form-control"})]})]}),(0,b.jsxs)("div",{className:"ProfileForm__group",children:[(0,b.jsx)(i.A,{children:(0,b.jsx)(t.A,{md:12,children:(0,b.jsxs)("div",{className:"ProfileForm__group",children:[(0,b.jsx)("label",{htmlFor:"billing_address",children:"  *Preferred pickup address "}),(0,b.jsx)(j.A,{setAddressSuburb:D,billingAddrs:T}),a.billing_address&&l.billing_address&&(0,b.jsxs)("div",{className:"error",children:[" ",a.billing_address]})]})})}),(0,b.jsxs)(i.A,{children:[(0,b.jsx)(t.A,{md:12,children:(0,b.jsx)("p",{style:{margin:"20px 0"},children:"  The default pickup address will apply to all new bookings moving forward. Updating your preferred pickup address will not affect the address linked to your current bookings. To change the pickup address for an existing booking, simply select the specific lesson from your dashboard and make the necessary updates"})}),(0,b.jsx)(t.A,{md:6,children:(0,b.jsxs)("div",{className:"ProfileForm__group",children:[(0,b.jsx)("label",{htmlFor:"suburb",children:"*Suburb"}),(0,b.jsx)("input",{type:"text",value:Array.isArray(C)?null===(s=C[1])||void 0===s?void 0:s.long_name:H.suburbName,className:"form-control",disabled:!0})]})}),(0,b.jsx)(t.A,{md:6,children:(0,b.jsxs)("div",{className:"ProfileForm__group",children:[(0,b.jsx)("label",{htmlFor:"state",children:"*State"}),(0,b.jsx)("input",{type:"text",value:Array.isArray(C)?null===(r=C[3])||void 0===r?void 0:r.long_name:O.stateName,className:"form-control",disabled:!0})]})})]})]}),(0,b.jsxs)("div",{className:"ProfileForm__group",children:[(0,b.jsx)("label",{htmlFor:"about_your_self",children:"Optional Note to Instructor(s)"}),(0,b.jsx)(n.D0,{as:"textarea",name:"optional_note_instructor",id:"state",className:"form-control"})]})]}),(0,b.jsx)("div",{className:"personalDetailsForm__top",children:(0,b.jsx)("h4",{children:"Notification Settings"})}),(0,b.jsxs)("div",{className:"d-flex flex-column flex-sm-row",children:[(0,b.jsxs)("fieldset",{className:"d-flex gap-0 flex-grow-1",children:[(0,b.jsx)("label",{htmlFor:"Email",children:"Email"}),(0,b.jsxs)("div",{className:"ProfileForm__group d-flex gap-2 m-1",children:[(0,b.jsx)(n.D0,{name:"email_comm_offer",children:e=>{let{field:s,form:r}=e;return(0,b.jsx)("input",{type:"checkbox",id:"email_comm_offer",checked:1===s.value,onChange:()=>r.setFieldValue("email_comm_offer",1===s.value?0:1)})}}),(0,b.jsx)("div",{className:"CheckboxHighlight"}),(0,b.jsx)("label",{htmlFor:"email_comm_offer",children:"Marketing Communications & Special Offers"})]})]}),(0,b.jsxs)("fieldset",{className:"d-flex gap-0 flex-grow-1",children:[(0,b.jsx)("label",{htmlFor:"SMS",children:"SMS"}),(0,b.jsxs)("div",{className:"ProfileForm__group d-flex gap-2 m-1",children:[(0,b.jsx)(n.D0,{name:"sms_comm_offer",children:e=>{let{field:s,form:r}=e;return(0,b.jsx)("input",{type:"checkbox",id:"sms_comm_offer",checked:1===s.value,onChange:()=>r.setFieldValue("sms_comm_offer",1===s.value?0:1)})}}),(0,b.jsx)("div",{className:"CheckboxHighlight"}),(0,b.jsx)("label",{htmlFor:"sms_comm_offer",children:"Marketing Communications & Special Offers"})]})]})]}),(0,b.jsx)("div",{className:"ProfileForm__actions",style:{justifyContent:"flex-end"},children:(0,b.jsx)("button",{type:"submit",className:"btn btn-teal",disabled:u,children:u?"Saving...":"Save Changes"})})]})}})]})]})})})}),(0,b.jsx)(g.N9,{})]})]})})}}}]);
//# sourceMappingURL=3003.48ed238e.chunk.js.map